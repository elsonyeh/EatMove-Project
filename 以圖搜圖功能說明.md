# 🔍 EatMove 以圖搜圖功能說明

## 📋 功能概述

EatMove 外送平台新增了**以圖搜圖**功能，讓用戶可以透過上傳食物照片來尋找相似的餐點和餐廳。此功能完全在本地運作，不依賴外部 API，確保隱私安全與快速響應。

## ✨ 主要特色

### 🎯 核心功能

- **本地化處理**：完全在瀏覽器中進行圖像分析，無需上傳至外部服務
- **智能特徵提取**：使用色彩直方圖、亮度、對比度、邊緣檢測等多維度分析
- **相似度計算**：基於多種圖像特徵的加權算法，提供精確的相似度評分
- **即時搜尋**：快速比對資料庫中的所有餐點圖片

### 🎨 視覺體驗

- **直覺式操作**：拖拽上傳或點擊選擇圖片
- **即時預覽**：圖片上傳後立即生成縮略圖
- **相似度顯示**：以百分比顯示每個結果的相似度
- **高亮標示**：在餐廳頁面中特別標示搜尋結果

## 🚀 使用方式

### 1. 開始搜尋

- 在首頁搜尋欄旁找到「以圖搜圖」按鈕
- 點擊按鈕開啟圖像搜尋對話框

### 2. 上傳圖片

- **方式一**：點擊虛線框內的「選擇檔案」按鈕
- **方式二**：直接將圖片拖拽到虛線框內
- **支援格式**：JPG、PNG、WebP
- **檔案限制**：最大 10MB

### 3. 調整設定

- **相似度門檻**：使用滑桿調整 10%-80%
  - 較低門檻：更多但可能不太相似的結果
  - 較高門檻：較少但更精確的結果

### 4. 開始搜尋

- 圖片分析完成後，點擊「開始搜尋」
- 系統會自動比對所有餐廳的菜單圖片
- 搜尋過程通常在幾秒鐘內完成

### 5. 查看結果

- 結果按相似度由高到低排列
- 每個結果顯示：
  - 餐點圖片
  - 餐點名稱
  - 餐廳名稱
  - 價格
  - 相似度百分比

### 6. 前往餐廳

- 點擊任一搜尋結果
- 自動跳轉到對應餐廳頁面
- 相似的餐點會被高亮標示
- 頁面會自動滾動到該餐點位置

## ⚙️ 技術原理

### 圖像特徵提取

1. **色彩直方圖 (60% 權重)**

   - RGB 三通道各 64 個色彩區間
   - 分析圖片的色彩分布特徵

2. **亮度分析 (15% 權重)**

   - 計算圖片的平均亮度
   - 識別食物的明暗特徵

3. **對比度分析 (15% 權重)**

   - 測量像素亮度的變化程度
   - 反映食物的質感和層次

4. **邊緣密度 (10% 權重)**
   - 使用梯度檢測邊緣
   - 識別食物的形狀和紋理

### 相似度計算

使用歐幾里得距離和直方圖交集等算法，將多個特徵融合成單一相似度分數(0-1)，越接近 1 表示越相似。

### 性能優化

- 圖片自動縮放到 256x256 像素進行分析
- 使用 Canvas API 進行高效的像素處理
- 異步處理避免界面卡頓

## 🎯 使用場景

### 情境一：不知道菜名

看到朋友分享的美食照片，不知道是什麼菜，可以用以圖搜圖找到相似的餐點。

### 情境二：尋找替代選項

想吃某道菜但原餐廳沒有營業，可以搜尋其他餐廳的相似料理。

### 情境三：探索新口味

對某種食物感興趣，想找到更多相似風格的餐點進行嘗試。

### 情境四：重複訂購

之前吃過很好吃的料理，但忘記餐廳名稱，可以用照片重新找到。

## 📊 搜尋結果說明

### 相似度評級

- **90%+ 極高相似**：幾乎相同的料理
- **70-89% 高度相似**：同類型但可能有細微差異
- **50-69% 中度相似**：相似風格或配色
- **30-49% 低度相似**：部分特徵相似
- **30%以下**：預設不顯示（可調整門檻）

### 結果排序

1. 首先按相似度排序
2. 同等相似度下按餐廳評分排序
3. 最多顯示 20 個結果避免資訊過載

## 🔧 注意事項

### 圖片品質建議

- **光線充足**：避免過暗或過曝的照片
- **清晰聚焦**：模糊的圖片會影響識別精度
- **主體突出**：食物應占據畫面主要部分
- **背景簡潔**：避免過於複雜的背景干擾

### 限制與注意

- 搜尋精度受圖片品質影響
- 主要識別視覺特徵，無法識別口味
- 搜尋範圍僅限平台內有圖片的餐點
- 圖片處理需要現代瀏覽器支援

### 隱私保護

- 圖片僅在瀏覽器本地處理
- 不會上傳到伺服器
- 分析完成後自動清除暫存資料

## 🛠️ 故障排除

### 常見問題

**Q: 上傳圖片後沒有反應？**
A: 檢查圖片格式是否支援，檔案大小是否超過 10MB。

**Q: 搜尋結果很少或沒有結果？**
A: 嘗試降低相似度門檻，或使用更清晰的圖片。

**Q: 搜尋結果不準確？**
A: 確保圖片光線充足且主體清晰，避免複雜背景。

**Q: 功能無法使用？**
A: 確認瀏覽器支援 Canvas API，建議使用 Chrome、Firefox 等現代瀏覽器。

### 瀏覽器兼容性

- ✅ Chrome 60+
- ✅ Firefox 55+
- ✅ Safari 12+
- ✅ Edge 79+
- ❌ Internet Explorer (不支援)

## 🔮 未來展望

### 計劃改進

1. **AI 增強**：結合機器學習提高識別精度
2. **分類篩選**：按料理類型、價格範圍等篩選結果
3. **用戶反饋**：讓用戶標記搜尋結果的準確性
4. **批量搜尋**：支援同時上傳多張圖片
5. **語音描述**：結合圖片與文字描述進行搜尋

### 預期效果

- 提升用戶發現新餐點的效率
- 增加平台的互動性和趣味性
- 降低用戶選擇困難的問題
- 促進餐廳間的良性競爭

---

**📞 需要協助？**
如果您在使用過程中遇到任何問題，請聯繫客服團隊，我們將竭誠為您服務！
