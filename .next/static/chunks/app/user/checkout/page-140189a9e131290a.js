(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5321],{968:(e,r,s)=>{"use strict";s.d(r,{b:()=>n});var t=s(2115),a=s(3655),i=s(5155),l=t.forwardRef((e,r)=>(0,i.jsx)(a.sG.label,{...e,ref:r,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||(null===(s=e.onMouseDown)||void 0===s||s.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));l.displayName="Label";var n=l},1135:(e,r,s)=>{"use strict";s.d(r,{w:()=>o});var t=s(5155),a=s(2115),i=s(3655),l="horizontal",n=["horizontal","vertical"],d=a.forwardRef((e,r)=>{var s;let{decorative:a,orientation:d=l,...c}=e,o=(s=d,n.includes(s))?d:l;return(0,t.jsx)(i.sG.div,{"data-orientation":o,...a?{role:"none"}:{"aria-orientation":"vertical"===o?o:void 0,role:"separator"},...c,ref:r})});d.displayName="Separator";var c=s(3999);let o=a.forwardRef((e,r)=>{let{className:s,orientation:a="horizontal",decorative:i=!0,...l}=e;return(0,t.jsx)(d,{ref:r,decorative:i,orientation:a,className:(0,c.cn)("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",s),...l})});o.displayName=d.displayName},1275:(e,r,s)=>{"use strict";s.d(r,{X:()=>i});var t=s(2115),a=s(2712);function i(e){let[r,s]=t.useState(void 0);return(0,a.N)(()=>{if(e){s({width:e.offsetWidth,height:e.offsetHeight});let r=new ResizeObserver(r=>{let t,a;if(!Array.isArray(r)||!r.length)return;let i=r[0];if("borderBoxSize"in i){let e=i.borderBoxSize,r=Array.isArray(e)?e[0]:e;t=r.inlineSize,a=r.blockSize}else t=e.offsetWidth,a=e.offsetHeight;s({width:t,height:a})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}s(void 0)},[e]),r}},2643:(e,r,s)=>{"use strict";s.d(r,{_:()=>n});var t=s(2115),a=s(3952),i=s(4503);let l={items:[],restaurantId:null,restaurantName:null};function n(){let{toast:e}=(0,i.dj)(),[r,s]=(0,t.useState)(!1),[n,d]=(0,a.M)("eatmove-cart",l);return(0,t.useEffect)(()=>{s(!0)},[]),{cart:n,addItem:function(s){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;r&&(d(r=>{if(0===r.items.length)return{...r,restaurantId:s.restaurantId,restaurantName:s.restaurantName,items:[{...s,quantity:t}]};if(r.restaurantId&&r.restaurantId!==s.restaurantId)return e({title:"無法添加商品",description:"您的購物車中已有來自 ".concat(r.restaurantName," 的商品。請先清空購物車或完成當前訂單。"),variant:"destructive"}),r;let a=r.items.findIndex(e=>e.id===s.id);if(a>-1){let e=[...r.items];return e[a].quantity+=t,{...r,items:e}}return{...r,items:[...r.items,{...s,quantity:t}]}}),e({title:"已添加到購物車",description:"".concat(s.name," x ").concat(t," 已添加到您的購物車")}))},removeItem:s=>{r&&(d(e=>{let r=e.items.filter(e=>e.id!==s);return 0===r.length?l:{...e,items:r}}),e({title:"已從購物車移除",description:"商品已從購物車中移除"}))},updateQuantity:(e,s)=>{r&&!(s<1)&&d(r=>{let t=r.items.map(r=>r.id===e?{...r,quantity:s}:r);return{...r,items:t}})},clearCart:()=>{r&&(d(l),e({title:"購物車已清空",description:"所有商品已從購物車中移除"}))},getSubtotal:()=>n.items.reduce((e,r)=>e+r.price*r.quantity,0),getTotalItems:()=>n.items.reduce((e,r)=>e+r.quantity,0),isInCart:e=>n.items.some(r=>r.id===e),getItemQuantity:e=>{let r=n.items.find(r=>r.id===e);return r?r.quantity:0},mounted:r}}},2982:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>p});var t=s(5155),a=s(2115),i=s(5695),l=s(7168),n=s(8482),d=s(9852),c=s(2714),o=s(2255),u=s(1135),m=s(9474),h=s(4503),x=s(2643);function p(){let e=(0,i.useRouter)(),{toast:r}=(0,h.dj)(),[s,p]=(0,a.useState)("cash"),{cart:f,getSubtotal:j,clearCart:v,mounted:g}=(0,x._)(),N=j();return g?0===f.items.length?(e.push("/user/cart"),null):(0,t.jsxs)("div",{className:"container py-6",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight mb-2",children:"結帳"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"完成您的訂單"})]}),(0,t.jsxs)("div",{className:"grid gap-8 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"md:col-span-2 space-y-6",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"配送資訊"})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("form",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"name",children:"姓名"}),(0,t.jsx)(d.p,{id:"name",placeholder:"請輸入姓名",defaultValue:"王小明"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"phone",children:"電話"}),(0,t.jsx)(d.p,{id:"phone",placeholder:"請輸入電話",defaultValue:"0912345678"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"address",children:"地址"}),(0,t.jsx)(d.p,{id:"address",placeholder:"請輸入地址",defaultValue:"台北市信義區信義路五段7號"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"notes",children:"備註"}),(0,t.jsx)(m.T,{id:"notes",placeholder:"有任何特殊要求嗎？"})]})]})})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"付款方式"})}),(0,t.jsxs)(n.Wu,{children:[(0,t.jsxs)(o.z,{value:s,onValueChange:p,children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.C,{value:"cash",id:"cash"}),(0,t.jsx)(c.J,{htmlFor:"cash",children:"貨到付款"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.C,{value:"credit",id:"credit"}),(0,t.jsx)(c.J,{htmlFor:"credit",children:"信用卡付款"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(o.C,{value:"crypto",id:"crypto"}),(0,t.jsx)(c.J,{htmlFor:"crypto",children:"虛擬代幣交易"})]})]}),"credit"===s&&(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"cardNumber",children:"卡號"}),(0,t.jsx)(d.p,{id:"cardNumber",placeholder:"請輸入卡號"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"cardName",children:"持卡人姓名"}),(0,t.jsx)(d.p,{id:"cardName",placeholder:"請輸入持卡人姓名"})]})]}),(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"expiry",children:"到期日"}),(0,t.jsx)(d.p,{id:"expiry",placeholder:"MM/YY"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"cvc",children:"安全碼"}),(0,t.jsx)(d.p,{id:"cvc",placeholder:"CVC"})]})]})]}),"crypto"===s&&(0,t.jsx)("div",{className:"mt-4 space-y-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"walletAddress",children:"錢包地址"}),(0,t.jsx)(d.p,{id:"walletAddress",placeholder:"請輸入錢包地址"})]})})]})]})]}),(0,t.jsx)("div",{children:(0,t.jsxs)(n.Zp,{className:"sticky top-20",children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"訂單摘要"})}),(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[f.items.map(e=>(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{children:[e.name," x ",e.quantity]}),(0,t.jsxs)("span",{children:["$",e.price*e.quantity]})]},e.id)),(0,t.jsx)(u.w,{}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"小計"}),(0,t.jsxs)("span",{children:["$",N]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)("span",{children:"外送費"}),(0,t.jsxs)("span",{children:["$",60]})]}),(0,t.jsx)(u.w,{}),(0,t.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,t.jsx)("span",{children:"總計"}),(0,t.jsxs)("span",{children:["$",N+60]})]})]}),(0,t.jsx)(n.wL,{children:(0,t.jsx)(l.$,{className:"w-full",onClick:s=>{s.preventDefault();let t=Math.floor(1e3*Math.random()).toString().padStart(3,"0");r({title:"訂單已送出",description:"您的訂單已成功送出，店家正在準備中"}),e.push("/user/orders/".concat(t)),setTimeout(()=>{v()},500)},children:"確認訂單"})})]})})]})]}):(0,t.jsx)("div",{className:"container py-6",children:(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight mb-2",children:"結帳"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"載入中..."})]})})}},3952:(e,r,s)=>{"use strict";s.d(r,{M:()=>a});var t=s(2115);function a(e,r){let[s,a]=(0,t.useState)(()=>{try{let s=window.localStorage.getItem(e);return s?JSON.parse(s):r}catch(e){return console.error(e),r}});return(0,t.useEffect)(()=>{let r=r=>{r.key===e&&r.newValue&&a(JSON.parse(r.newValue))};return window.addEventListener("storage",r),()=>window.removeEventListener("storage",r)},[e]),[s,r=>{try{let t=r instanceof Function?r(s):r;a(t),window.localStorage.setItem(e,JSON.stringify(t))}catch(e){console.error(e)}}]}},5503:(e,r,s)=>{"use strict";s.d(r,{Z:()=>a});var t=s(2115);function a(e){let r=t.useRef({value:e,previous:e});return t.useMemo(()=>(r.current.value!==e&&(r.current.previous=r.current.value,r.current.value=e),r.current.previous),[e])}},5695:(e,r,s)=>{"use strict";var t=s(8999);s.o(t,"useParams")&&s.d(r,{useParams:function(){return t.useParams}}),s.o(t,"usePathname")&&s.d(r,{usePathname:function(){return t.usePathname}}),s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(r,{useSearchParams:function(){return t.useSearchParams}})},6018:(e,r,s)=>{Promise.resolve().then(s.bind(s,2982))},9474:(e,r,s)=>{"use strict";s.d(r,{T:()=>l});var t=s(5155),a=s(2115),i=s(3999);let l=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...a})});l.displayName="Textarea"},9852:(e,r,s)=>{"use strict";s.d(r,{p:()=>l});var t=s(5155),a=s(2115),i=s(3999);let l=a.forwardRef((e,r)=>{let{className:s,type:a,...l}=e;return(0,t.jsx)("input",{type:a,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm text-black ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:r,...l})});l.displayName="Input"},9946:(e,r,s)=>{"use strict";s.d(r,{A:()=>d});var t=s(2115);let a=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return r.filter((e,r,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===r).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,t.forwardRef)((e,r)=>{let{color:s="currentColor",size:a=24,strokeWidth:n=2,absoluteStrokeWidth:d,className:c="",children:o,iconNode:u,...m}=e;return(0,t.createElement)("svg",{ref:r,...l,width:a,height:a,stroke:s,strokeWidth:d?24*Number(n)/Number(a):n,className:i("lucide",c),...m},[...u.map(e=>{let[r,s]=e;return(0,t.createElement)(r,s)}),...Array.isArray(o)?o:[o]])}),d=(e,r)=>{let s=(0,t.forwardRef)((s,l)=>{let{className:d,...c}=s;return(0,t.createElement)(n,{ref:l,iconNode:r,className:i("lucide-".concat(a(e)),d),...c})});return s.displayName="".concat(e),s}}},e=>{var r=r=>e(e.s=r);e.O(0,[9352,4052,1116,8441,1684,7358],()=>r(6018)),_N_E=e.O()}]);